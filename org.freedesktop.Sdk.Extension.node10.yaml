app-id: org.freedesktop.Sdk.Extension.node10
branch: '18.08'
runtime: org.freedesktop.Sdk
runtime-version: '18.08'
sdk: org.freedesktop.Sdk
build-extension: true
separate-locales: false
appstream-compose: false
build-options:
  prefix: /usr/lib/sdk/node10
modules:
  - name: node
    sources:
      - type: archive
        url: https://nodejs.org/dist/latest-v10.x/node-v10.20.1.tar.xz
        sha256: ee1f88a04c608aeda1299bbcb0895eebb6394e901f03398c377236905d95f492
        x-checker-data:
          type: html
          url: https://nodejs.org/dist/latest-v10.x/
          url-pattern: (node-v[\d\.-]+.tar.xz)
          version-pattern: node-v([\d\.-]+).tar.xz
        size: 21947588
    config-opts:
      - --openssl-use-def-ca-store
      - --shared-openssl
      - --shared-zlib
      - --with-intl=system-icu

  - name: scripts
    buildsystem: simple
    build-commands:
      - cp {enable,install{,-sdk}}.sh /usr/lib/sdk/node10
      - mkdir -p /usr/lib/sdk/node10/share/metainfo
      - cp org.freedesktop.Sdk.Extension.node10.appdata.xml /usr/lib/sdk/node10/share/metainfo
      - appstream-compose --basename=org.freedesktop.Sdk.Extension.node10 --prefix=${FLATPAK_DEST}
        --origin=flatpak org.freedesktop.Sdk.Extension.node10
    sources:
      - type: script
        dest-filename: install.sh
        commands:
          - install -Dm 755 /usr/lib/sdk/node10/bin/node ${FLATPAK_DEST}/node/bin/node
      - type: script
        dest-filename: install-sdk.sh
        commands:
          - cp -r /usr/lib/sdk/node10 ${FLATPAK_DEST}/node
      - type: script
        commands:
          - export PATH=$PATH:/usr/lib/sdk/node10/bin
          - export npm_config_nodedir=/usr/lib/sdk/node10
        dest-filename: enable.sh
      - type: file
        path: org.freedesktop.Sdk.Extension.node10.appdata.xml
